запускали в терминале
Как исправить (самый простой и надёжный способ)
Явно квалифицируй столбцы через имя CTE (daily.).
Исправленный вариант функции daily_report:
SQLCREATE OR REPLACE FUNCTION daily_report(
    p_account_number VARCHAR,
    p_start_date     DATE,
    p_end_date       DATE
)
RETURNS TABLE (
    report_date     DATE,
    income          NUMERIC(15,2),
    expense         NUMERIC(15,2),
    balance         NUMERIC(15,2)
)
LANGUAGE plpgsql
AS $$
BEGIN
    RETURN QUERY
    WITH daily AS (
        SELECT 
            tx_date,
            SUM(CASE WHEN operation_type = 'приход' THEN amount ELSE 0 END) AS income,
            SUM(CASE WHEN operation_type = 'расход' THEN amount ELSE 0 END) AS expense
        FROM transactions
        WHERE account_number = p_account_number
          AND tx_date BETWEEN p_start_date AND p_end_date
        GROUP BY tx_date
    ),
    running AS (
        SELECT 
            daily.tx_date          AS report_date,
            daily.income,
            daily.expense,
            SUM(daily.income - daily.expense) OVER (ORDER BY daily.tx_date) AS balance
        FROM daily
    )
    SELECT * FROM running
    ORDER BY report_date;
END;
$$;
То же самое нужно сделать и для monthly_report:
SQLCREATE OR REPLACE FUNCTION monthly_report(
    p_account_number VARCHAR,
    p_start_date     DATE,
    p_end_date       DATE
)
RETURNS TABLE (
    report_month    DATE,
    income          NUMERIC(15,2),
    expense         NUMERIC(15,2),
    balance         NUMERIC(15,2)
)
LANGUAGE plpgsql
AS $$
BEGIN
    RETURN QUERY
    WITH monthly AS (
        SELECT 
            DATE_TRUNC('month', tx_date)::DATE AS month_start,
            SUM(CASE WHEN operation_type = 'приход' THEN amount ELSE 0 END) AS income,
            SUM(CASE WHEN operation_type = 'расход' THEN amount ELSE 0 END) AS expense
        FROM transactions
        WHERE account_number = p_account_number
          AND tx_date BETWEEN p_start_date AND p_end_date
        GROUP BY month_start
    ),
    running AS (
        SELECT 
            monthly.month_start    AS report_month,
            monthly.income,
            monthly.expense,
            SUM(monthly.income - monthly.expense) OVER (ORDER BY monthly.month_start) AS balance
        FROM monthly
    )
    SELECT * FROM running
    ORDER BY report_month;
END;
$$;